# 游戏本地化

**阅读本文大概需要15分钟**

## 什么是游戏语言本地化
- 游戏本地化是指让编辑器制作的游戏能够显示不同的语种，帮助游戏适应不同的语言环境
- 游戏本地化功能包括以下三部分功能：
  - 一、收集原文本
  - 二、自动翻译或自行翻译后导入
  - 三、运行时替换为翻译文本
 ![](https://cdn.233xyx.com/online/MyCCUQE7dyqw1721359399452.png)

 ## 游戏本地化使用流程
### 第1阶段-收集原文本
#### 方法一：一键收集UI文件中的原文本
  - 从主编辑器顶部入口打开本地化窗口，点击【收集文本】，可以把当前项目所有UI文件内UI控件配置的文本收集起来；
  ![](https://cdn.233xyx.com/online/6J9WwYfLzQDu1721359399877.png)
  - 文本框/输入框等允许配置文本的UI控件在属性面板上有一个【本地化】开关，打开时才能收集到该控件配置的文本，该开关默认打开；
  ![](https://cdn.233xyx.com/online/CZlxjr5qVzpY1721359400309.png)
  - 点击收集文本后，会弹出选择收集方式的窗口，可以选择【覆盖】或【新增】：选择【覆盖】会将多语言表中的文本记录删除并重新收集，选择【新增】只会新增当前多语言表中没有的原文本；
  ![](https://cdn.233xyx.com/online/QihUEnBiBNQ51721359400756.png)
  - 完全相同的原文本只会被收集到一次，多条重复的原文本条目在收集或导入时会自动去重只保留一条。
#### 方法二：一键收集脚本中用addKey标记的原文本
  - 对于脚本中动态设置的文本，无法提前填在UI文件中，可以将原文本用LanguageUtil.addKey(“Test”)方法标记，然后与方法一相同，点击本地化窗口中【收集文本】按钮，即可将脚本中标记的原文本收集到多语言表中；
  - addKey方法本身在运行时不会起任何作用，仅用于标记是否能被本地化功能自动收集到；因此如果该原文本已经通过其他方法收集到多语言表中，即使不用addKey标记，运行时也能替换为翻译文本。
```ts
//以下两种写法在运行时没有区别，区别只是是否能被本地化收集文本功能收集到，需要手动点击本地化窗口中【收集文本】按钮进行收集
this.tiptxt.text = LanguageUtil.addKey("Test")
this.tiptxt.text = "Test"
```
#### 方法三：自行整理原文本表格并导入（推荐）
  - 首先，点击本地化窗口底部的【导出】按钮，将当前项目的多语言表导出为一个csv文件，将项目中用到的原文本都填写在csv文件内第A列中；
  - 然后，点击本地化窗口的【导入】按钮，选择导入模式为【覆盖】或【新增】之后确认，即可将整理完成的csv文件导入当前项目的多语言表；
  - 请注意导入表格的结构和表头名务必与导出的表格相同，否则无法正确识别；
  ![](https://cdn.233xyx.com/online/fcjX4KK53eCg1721359401184.png)
![](https://cdn.233xyx.com/online/0FvPKTILZcLZ1721359401627.png)
  - 可以与前两种方法组合使用，例如先自动收集UI文件和脚本中标记的文本，此外再自行整理一份原语言表格并导入，注意选择导入模式为【新增】；
  - 已应用的多语言表在项目中的存储路径为——项目名\Translation\Translation.csv，如果某次自动收集/自动翻译功能的结果不理想，可以在前一版项目文件内找到上一版多语言表重新导入。
![](https://cdn.233xyx.com/online/oInmjdNPzpyr1721359402117.png)
![](https://cdn.233xyx.com/online/LfIGYiiajnsf1721359402540.png)

### 第2阶段-自动翻译或自行翻译
#### 方法一：使用编辑器的自动翻译功能
  - 在完成原文本收集后，可以使用编辑器提供的机器翻译功能，先选择原文本语言种类，然后点击自动翻译按钮，等待完成自动翻译；编辑器目前支持英语、中文（简体）、中文（繁体）、西班牙语、法语、俄语、葡萄牙语、日语、朝鲜语共九种语言之间进行机器翻译。
![](https://cdn.233xyx.com/online/lJzT9zlQcLYO1721359402981.png)
  - 本地化窗口底部会显示当前剩余没被翻译完成的条目数量，如果出现个别原文本无法被机器翻译的情况，请自行翻译后填写到表格中；
  - 请选择正确的原文本语言种类，否则自动翻译可能无法获得合理的翻译结果；
  - 为了防止自行翻译的条目（也就是下文的方法二）或校准过的条目被自动翻译覆盖，自动翻译只会翻译当前多语言表中空着的格子。

#### 方法二：自行翻译并将表格导入
  - 与收集原文本的方法三类似，如果希望追求较高的翻译质量，可以导出一份原文本csv表格，自行人工翻译，将翻译后的文本csv文件内第B列至第J列，再将翻译后的表格并导入；
![](https://cdn.233xyx.com/online/CmlkPTTnpDZW1721359403420.png)
  - 人工翻译可以与自动翻译组合使用，例如先人工翻译一种重点语言，填入导出后的多语言表，然后再导入，使用自动翻译功能把剩余几种非重点语言翻译出来。

### 第3阶段-运行时替换为翻译文本
#### 方法一：运行时根据APP语言自动替换为目标语言的翻译文本
  - 游戏拉起时引擎会读取玩家在APP设置的语言种类，自动调用LanguageUtil.setLanguage接口将游戏语言设置为这一语言；也就是说，只要多语言表中记录了目标语言完整的翻译文本，不需要调用任何接口，就能自动选择目标语言；
  - 运行时设置语言种类后，会检索各处使用的文本是否存在于多语言表的原文本列中，注意要与原文本完全相同才能被识别，识别后该处文本会自动替换为目标语言的翻译文本；
  - 为了保证只进行了某种或者某几种语言本地化适配的项目也能正常游玩，目标语言选择的优先级为：APP语言→英语→原语言；即如果语言表中没有任何App语言的翻译文本就显示英语的翻译文本，如果语言表中没有任何英语的翻译文本就显示原语言。
#### 方法二：运行时使用getText获取多语言表中指定原文本的翻译文本
  - 该方法主要用于处理动态拼接文本或者图片/声音本地化等需要动态获取翻译表中的翻译文本的情况（简单的拼接文本也可以用占位符处理）。
```ts
//获取多语言表中某条原文本对应当前目标语言的翻译文本
this.tiptxt.text = LanguageUtil.getText("Test")
this.tiptxt.text = LanguageUtil.getText("Test1")+"number"+LanguageUtil.getText("Test2")
```
 ## 如何处理图片/声音本地化
 ## 如何使用占位符处理动态拼接文本
 ## 如何预览切换语言后的效果
 ## 如何让切换语言后的界面更加美观
 ### 使用自适应文本框及最大最小字号功能
### 制作UI时做好规划，预留翻译空间




![]()
  <video controls src="https://cdn.233xyx.com/1691042312370_391.mp4"></video>



